"""
保險專業詞庫
Insurance Professional Dictionary

包含保險業相關的專業術語、公司名稱、產品類型等
"""

# 保險公司
INSURANCE_COMPANIES = [
    # 壽險公司
    '國泰人壽', '南山人壽', '富邦人壽', '新光人壽', '台灣人壽',
    '中國人壽', '宏泰人壽', '保德信人壽', '第一金人壽', '台銀人壽',
    '三商美邦人壽', '遠雄人壽', '安聯人壽', '中華郵政', '郵政簡易人壽',
    '全球人壽', '法國巴黎人壽', '合作金庫人壽', '康健人壽', '安達人壽', 
    '友邦人壽', '英屬保誠人壽', '元大人壽', '陽信人壽', '幸福人壽',
    '國際康健人壽', '國寶人壽', '新光大樹保險', '公教保險部', '人壽保險',
    '人壽公司', '壽險公司', '壽險業者',
    
    # 產險公司
    '新光產險', '富邦產險', '國泰世華產險', '明台產險', '華南產險',
    '第一產險', '兆豐產險', '泰安產險', '和泰產險', '台灣產險',
    '旺旺友聯產險', '中央再保險', '臺灣再保險', '法國巴黎產物保險', '美亞產險',
    '新安東京海上產險', '蘇黎世產物保險', '富邦金控', '國泰金控', '新光金控',
    '中央產險', '安聯產險', '法商安盛保險', '南山產物保險', '凱基保險',
    '產險公司', '產險業者', '產物保險',
    
    # 保險媒合/經紀公司
    '保險經紀人', '保險代理人', '保經公司', '保代公司', 
    '怡安保經', '達信保經', '威利保險經紀人', '康蓁保經', '泰安保經',
    '長青保經', '華匯保經', '台灣風險管理', '大華保經', '全球人壽保代'
]

# 保險產品類型
INSURANCE_PRODUCTS = [
    # 人身保險 - 壽險
    '壽險', '終身壽險', '定期壽險', '萬能壽險', '投資型壽險',
    '變額壽險', '變額萬能壽險', '利變壽險', '增額終身壽險', '生死合險',
    '增值型保險', '還本型保險', '儲蓄險', '生存保險', '死亡保險',
    '養老保險', '信用壽險', '高保額壽險', '小額終老保險', '微型保險',
    '實物給付型保險', '投資連結型保險', 'ILP', 'VUL', '生前理賠',
    
    # 人身保險 - 健康醫療
    '健康險', '醫療險', '癌症險', '重大疾病險', '失能險',
    '長照險', '長期照護險', '防癌保險', '住院醫療險', '手術險',
    '實支實付型醫療險', '日額型醫療險', '特定傷病險', '職業失能險', '殘廢扶助險',
    '失能照護險', '重疾險', '特定傷病險', '長期傷病險', '防癌健康險',
    '醫療費用險', '住院日額', '手術費用保障', '醫療補償', '失能給付',
    
    # 人身保險 - 意外/其他
    '意外險', '旅平險', '傷害險', '職業災害險', '旅遊不便險',
    '旅行平安險', '交通意外險', '航空險', '公共運輸傷害險', '海外緊急救援',
    '旅行不便險', '劫機保險', '旅程延誤', '行李遺失', '海外醫療',
    '緊急救援', '傷害醫療保險', '旅遊不便保險', '行程取消險', '班機延誤險',
    '行李延誤險', '護照遺失險', '緊急援助險', '海外急難救助',
    
    # 人身保險 - 退休金/年金
    '年金險', '退休金', '養老險', '儲蓄險', '增額年金',
    '即期年金', '遞延年金', '確定年金', '終身年金', '定期年金',
    '勞退自提', '勞工退休金', '個人退休金', '企業退休金', '退休理財',
    '退休規劃', '退休保障', '高齡化社會', '安養信託', '以房養老',
    '退休準備', '退休收入', '退休生活', '老年保障', '第三支柱',
    
    # 財產保險 - 財損
    '火險', '地震險', '颱風險', '住宅險', '房屋險',
    '商業火災保險', '營業中斷險', '財物保險', '竊盜險', '水漬險',
    '颱風洪水險', '保險櫃', '現金保險', '玻璃保險', '藝術品保險',
    '珠寶保險', '租金損失險', '營運中斷險', '營業損失險', '企業財產保險',
    '商業綜合保險', '特定事故保險', '爆炸保險', '自然災害保險', '意外事故險',
    
    # 財產保險 - 車險
    '汽車險', '機車險', '第三人責任險', '車體險', '強制汽車責任保險',
    '任意汽車保險', '全險', '車體損失險', '竊盜損失險', '乘客險',
    '駕駛人傷害險', '超額責任險', '國外責任險', '拖車費用', '玻璃險',
    '車損險', '交通事故', '肇事責任', '汽車保險', '機車保險',
    '酒駕條款', '酒駕除外不保', '交通事故理賠', '強制險', '強制車險',
    
    # 財產保險 - 責任險
    '責任險', '產品責任險', '僱主責任險', '董監事責任險', '公共意外責任險',
    'D&O險', '營運人責任險', '電梯意外險', '營業場所責任險', '專業責任保險',
    '醫師責任保險', '律師責任保險', '會計師責任險', '建築師責任險', '旅行社責任險',
    '保全業責任保險', '體育活動責任險', '商業責任保險', '家庭責任保險', '個人責任保險',
    '第三人責任', '附加責任', '超額責任', '雇主意外責任', '公共場所責任',
    
    # 財產保險 - 工程/海上險
    '工程險', '海上險', '貨物險', '電子設備險', '營建工程保險',
    '安裝工程保險', '機械保險', '機械故障保險', '營造綜合險', '營建材料險',
    '施工機具險', '船舶險', '船體險', '貨物運輸險', '漁船險',
    '遊艇險', '航運保險', '貨運險', '海損險', '共同海損',
    '海上貨物運輸保險', '內陸運輸保險', '空運保險', '郵包險', '運輸險',
    
    # 其他創新保險產品
    '參數型保險', '指數型保險', '天氣保險', '農業保險', '收入保險',
    '數位保險', '網路風險險', '資安保險', '寵物險', '旅遊不便險',
    '生育保險', '視訊看診險', '疫苗險', '疫情保險', 'COVID保險',
    '疾病防疫險', '小額信貸保險', '個人資料保護險', '數位產品保固險', '延長保固險',
    '智慧裝置保險', '共享經濟保險', '無人機保險', '綠能設備保險', '數位貨幣保險'
]

# 保險專業術語
INSURANCE_TERMS = [
    # 基本概念
    '保險', '保費', '保單', '保額', '保障', '理賠', '核保',
    '要保人', '被保險人', '受益人', '保險人', '承保',
    '投保', '續保', '解約', '退保', '減額繳清',
    '保險業者', '保險商品', '保險利益', '保險期間', '保險費率',
    '保險契約', '條款', '保單條款', '保單價值', '保險金額', 
    '受益憑證', '同意書', '契約', '告知義務', '誠實告知',
    '除外責任', '除外不保', '責任免除', '給付項目', '責任',
    
    # 保單管理
    '繳費', '繳費方式', '年繳', '月繳', '躉繳',
    '保單貸款', '保費緩繳', '展期定期保險', '自動墊繳保費', '復效',
    '停效', '保單借款', '部分提領', '保單帳戶價值', '保單紅利',
    '解約金', '解約費用', '提前解約', '契約轉換', '契約變更',
    '保單分紅', '紅利分配', '保單審閱期', '撤銷期', '猶豫期',
    '保單生效日', '投保日', '繳費期滿日', '保障期滿日', '保單週年日',
    
    # 理賠相關
    '理賠金', '保險金', '身故給付', '殘廢給付', '醫療給付',
    '住院日額', '手術費用', '實支實付', '定額給付',
    '免賠額', '自負額', '等待期', '觀察期', '短期費率',
    '比例賠付', '理賠申請', '保險事故', '理賠給付', '第一次理賠',
    '理賠金額', '理賠審核', '保險賠償', '追償權', '代位求償',
    '保險代位', '賠付限額', '理賠資格', '理賠文件', '理賠證明',
    '損失證明', '損失鑑定', '出險通知', '理賠申請書', '出險',
    '理賠單位', '理賠專員', '理賠調查', '理賠流程', '給付比例',
    '給付期間', '不保事項', '除外事項', '保險詐欺', '道德風險',
    
    # 保險業務
    '保險業務員', '保險經紀人', '保險代理人', '精算師',
    '保險公證人', '損失勘定', '風險評估', '核保評估',
    '業務招攬', '招攬行為', '招攬規範', '招攬文件', '業務員登錄證',
    '業務員資格', '保險顧問', '保險規劃', '風險管理', '財務規劃',
    '業務人員', '展業人員', '銷售人員', '服務人員', '保險專員',
    '通路', '銀行保險', '銀行通路', '保經代', '直營通路',
    '電話行銷', '電話招攬', '數位招攬', '線上投保', '業務組織',
    '佣金制度', '獎金制度', '績效考核', '續保率', '保單繼承',
    '轉介紹', '客戶開發', '客戶經營', '客戶服務', '售後服務',
    '保單健檢', '保單診斷', '保障缺口', '需求分析', '風險承擔',
    
    # 核保與精算
    '核保準則', '核保流程', '核保通過', '體況加費', '額外風險',
    '標準體', '次標準體', '拒保', '延期核保', '限制條款',
    '體檢', '醫療核保', '財務核保', '核保條件', '核保危險評估',
    '精算', '精算原理', '精算假設', '死亡率', '罹病率',
    '理賠率', '費用率', '脫退率', '經驗率', '保險費計算',
    '保險數學', '利率假設', '現金流量', '現值', '未來價值',
    '生命表', '經驗生命表', '死亡機率', '生存機率', '保險統計',
    '風險係數', '風險保費', '費差', '死差', '利差',
    '保費結構', '毛保費', '淨保費', '附加費用', '保單管理費',
    
    # 監管相關
    '金管會', '保險局', '保險安定基金', '保險犯罪防制中心',
    '資本適足率', 'RBC', '清償能力', '準備金',
    '責任準備金', '特別準備金', '未到期保費準備金',
    '保險法', '保險業法', '金融監理', '法令遵循', '洗錢防制',
    '風險基礎資本額', '資產配置', '償付能力', '投資規範', '監理沙盒',
    '業務檢查', '金融檢查', '法遵制度', '內控內稽', '公司治理',
    '資訊公開', '保單審查', '商品送審', '費率審查', '保單條款審查',
    '監理政策', '保險政策', '金融政策', '強制保險', '政策性保險',
    '投資型保險規範', '保險商品分類', '銷售規範', '銷售行為管理', '適合度原則',
    '善良管理人', '專業規範', '個人資料保護', '消費者保護', '投訴處理',
    
    # 新興概念
    '保險科技', 'InsurTech', '數位轉型', '線上投保',
    '區塊鏈保險', '人工智慧核保', '大數據分析',
    '參數型保險', '小額保險', '微型保險',
    '保險APP', '行動投保', '行動理賠', '電子保單', '數位保險',
    '即時理賠', '理賠自動化', '人臉辨識', 'OCR技術', '區塊鏈技術',
    '智能合約', '保險物聯網', '穿戴式裝置', '健康管理', '智能客服',
    '機器人顧問', '聊天機器人', '數據驅動', '預測分析', '風險預測',
    '個人化保險', '隨用即付保險', '共享經濟保險', '數位平台', '生態系統',
    '開放銀行', '開放保險', 'API整合', '數位生態圈', '跨業合作',
    '永續保險', 'ESG投資', '綠色金融', '氣候變遷風險', '碳中和',
    '普惠金融', '保險教育', '保險素養', '客戶體驗', '使用者介面'
]

# 金融監管機構
REGULATORY_BODIES = [
    '金融監督管理委員會', '金管會', '保險局', '保險監理',
    '中央銀行', '央行', '財政部', '國稅局',
    '保險事業發展中心', '保發中心', '保險研究發展中心',
    '保險安定基金', '保險犯罪防制中心', '金融消費評議中心',
    '保險爭議處理機構', '金融消費者保護法', '金融監理制度',
    '中華民國人壽保險商業同業公會', '人壽保險公會', '產物保險公會',
    '中華民國產物保險商業同業公會', '保險公會', '金融研訓院',
    '保險事業發展中心', '人身保險協會', '金融研究發展基金會',
    '保險經紀人商業同業公會', '保險代理人商業同業公會',
    '保險業風險管理實務守則', '保險業公司治理實務守則',
    '中華民國精算學會', '風險管理學會', '財團法人保險事業發展中心'
]

# 保險相關法規
INSURANCE_LAWS = [
    '保險法', '保險業法', '強制汽車責任保險法',
    '保險代理人管理規則', '保險經紀人管理規則', '保險公證人管理規則',
    '保險業務員管理規則', '保險業招攬及核保理賠辦法',
    '人身保險商品審查應注意事項', '財產保險商品審查應注意事項',
    '保險業資本適足性管理辦法', '保險業內部控制及稽核制度實施辦法',
    '保險業辦理電子商務應注意事項', '投資型保險商品銷售應注意事項',
    '金融消費者保護法', '消費者保護法', '個人資料保護法',
    '保險業風險管理實務守則', '洗錢防制法', '金融機構防制洗錢辦法',
    '保險業經營保險電子商務自律規範', '保險業務員資格考試規則',
    '保險業資金運用辦法', '保險業辦理放款其他相關業務規範',
    '保險法施行細則', '保險業辦理再保險業務應注意事項',
    '強制汽車責任保險條例', '傷害保險單示範條款', '健康保險單示範條款',
    '住宅地震保險共保組織實施辦法', '汽車損失保險單條款',
    '財產保險業辦理農業保險示範條款', '旅行業責任保險示範條款',
    '公共意外責任保險單示範條款', '董監事責任保險示範條款',
    '信用保險示範條款', '保險商品銷售前程序作業準則',
    '保險業招攬廣告自律規範', '保險業招攬廣告自律規範說明',
    '保險業公平待客原則', '金融服務業公平待客原則',
    '保險業風險管理實務守則', '保險業防制洗錢及打擊資恐注意事項'
]

# 財經相關術語
FINANCIAL_TERMS = [
    '匯率', '利率', '通膨', '通貨膨脹', '經濟成長',
    'GDP', '失業率', '股市', '債券', '外匯',
    '新台幣', '美元', '人民幣', '日圓', '歐元',
    '升息', '降息', '量化寬鬆', 'QE', '經濟衰退',
    '景氣循環', '經濟指標', '通貨緊縮', '金融危機', '金融風暴',
    '聯準會', '財政政策', '貨幣政策', '稅制', '稅率',
    '資產配置', '投資組合', '投資策略', '風險分散', '流動性',
    '國內生產毛額', '經濟成長率', '消費者物價指數', 'CPI', '核心物價',
    '薪資成長率', '家庭收入', '家庭支出', '儲蓄率', '消費力',
    '全球經濟', '國際金融', '貿易戰', '關稅', '貿易逆差',
    '經常帳', '財政赤字', '國債', '政府預算', '財政收支',
    '證券市場', '股票', '基金', '資產管理', '財富管理',
    '金融商品', '金融市場', '衍生性商品', '期貨', '選擇權',
    '投資信託', '共同基金', 'ETF', 'REITs', '指數型基金',
    '創業投資', '風險投資', '私募基金', '融資', '信貸',
    '消費金融', '房貸', '車貸', '信用卡', '支付系統',
    '電子支付', '行動支付', '數位金融', '網路銀行', '虛擬貨幣',
    '加密貨幣', '區塊鏈金融', '綠色金融', 'ESG投資', '永續金融'
]

# 醫療長照術語
MEDICAL_TERMS = [
    '醫療', '醫院', '診所', '醫師', '護理師',
    '長照', '長期照護', '居家照護', '日間照顧', '安養機構',
    '養護中心', '護理之家', '老人福利機構', '銀髮族', '高齡化',
    '失智症', '失能', '身心障礙', '慢性病', '重大傷病',
    '健保', '全民健康保險', '部分負擔', '自費項目', '健保給付',
    '醫療費用', '住院費用', '手術費用', '藥物治療', '復健治療',
    '癌症治療', '癌症手術', '放射治療', '化學治療', '標靶治療',
    '免疫治療', '器官移植', '人工關節', '心導管', '心臟支架',
    '心臟瓣膜', '心血管疾病', '三高', '高血壓', '高血糖',
    '高血脂', '糖尿病', '腎臟病', '洗腎', '腎臟透析',
    '長照2.0', '長照保險', '長照給付', '長照服務', '居家服務',
    '喘息服務', '輔具', '無障礙設施', '居家改造', '老人照顧',
    '高齡照護', '社區照顧', '照顧服務員', '照顧管理', '照顧計畫',
    '預防保健', '健康檢查', '篩檢', '疫苗', '流感疫苗'
]

# 合併所有詞庫
ALL_INSURANCE_KEYWORDS = (
    INSURANCE_COMPANIES + 
    INSURANCE_PRODUCTS + 
    INSURANCE_TERMS + 
    REGULATORY_BODIES + 
    INSURANCE_LAWS + 
    FINANCIAL_TERMS +
    MEDICAL_TERMS
)

def get_insurance_keywords():
    """取得所有保險相關關鍵字"""
    return ALL_INSURANCE_KEYWORDS

def is_insurance_related(text: str, threshold: int = 1) -> bool:
    """
    檢查文本是否與保險相關
    
    Args:
        text: 要檢查的文本
        threshold: 最少需要包含的關鍵字數量
    
    Returns:
        bool: 是否與保險相關
    """
    if not text:
        return False
    
    text_lower = text.lower()
    count = 0
    
    for keyword in ALL_INSURANCE_KEYWORDS:
        if keyword.lower() in text_lower:
            count += 1
            if count >= threshold:
                return True
    
    return False

def extract_insurance_keywords(text: str) -> list:
    """
    從文本中提取保險相關關鍵字
    
    Args:
        text: 要分析的文本
    
    Returns:
        list: 找到的保險關鍵字列表
    """
    if not text:
        return []
    
    found_keywords = []
    text_lower = text.lower()
    
    for keyword in ALL_INSURANCE_KEYWORDS:
        if keyword.lower() in text_lower:
            found_keywords.append(keyword)
    
    return list(set(found_keywords))  # 去重

def calculate_insurance_relevance_score(text: str) -> float:
    """
    計算文本的保險相關性評分
    
    Args:
        text: 要評分的文本
    
    Returns:
        float: 相關性評分 (0-1)
    """
    if not text:
        return 0.0
    
    keywords = extract_insurance_keywords(text)
    text_length = len(text)
    
    if text_length == 0:
        return 0.0
    
    # 基礎評分：關鍵字數量 / 文本長度 * 1000
    base_score = len(keywords) / text_length * 1000
    
    # 調整評分到 0-1 範圍
    score = min(base_score * 10, 1.0)
    
    # 如果包含多個關鍵字，給予額外加分
    if len(keywords) >= 3:
        score = min(score * 1.2, 1.0)
    
    return round(score, 3)

def get_insurance_companies() -> list:
    """
    取得保險公司列表
    
    Returns:
        list: 保險公司名稱列表
    """
    return INSURANCE_COMPANIES

if __name__ == "__main__":
    # 測試詞庫功能
    test_texts = [
        "台灣人壽推出新的醫療險產品，保費優惠中",
        "金管會公布最新的保險業監管規定",
        "今天天氣很好，適合出門散步",
        "富邦人壽與國泰人壽在壽險市場競爭激烈"
    ]
    
    print("🧪 保險詞庫測試結果:")
    for i, text in enumerate(test_texts, 1):
        keywords = extract_insurance_keywords(text)
        score = calculate_insurance_relevance_score(text)
        is_related = is_insurance_related(text)
        
        print(f"\n{i}. 文本: {text}")
        print(f"   保險相關: {'是' if is_related else '否'}")
        print(f"   相關性評分: {score}")
        print(f"   找到關鍵字: {keywords}")
