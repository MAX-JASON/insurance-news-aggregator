@echo off
chcp 65001 >nul 2>&1
title å°ç£ä¿éšªæ–°èžèšåˆå™¨

echo ===================================================
echo   å°ç£ä¿éšªæ–°èžèšåˆå™¨å•Ÿå‹•ç¨‹åº (ç°¡åŒ–ç‰ˆ)
echo   Taiwan Insurance News Aggregator
echo   (å·²æ›´æ–°ï¼šæ”¯æ´é‡çµ„å¾Œçš„æª”æ¡ˆçµæ§‹)
echo ===================================================
echo.

color 0A
cd /d "%~dp0"

echo æ­£åœ¨å•Ÿå‹•ç³»çµ±ï¼Œè«‹ç¨å€™...
echo.

:: æª¢æŸ¥Pythonç’°å¢ƒ
set PYTHON_PATH=%~dp0venv\Scripts\python.exe
if not exist "%PYTHON_PATH%" (
    color 0C
    echo [éŒ¯èª¤] æ‰¾ä¸åˆ°Pythonè™›æ“¬ç’°å¢ƒï¼
    echo è·¯å¾‘: %PYTHON_PATH%
    echo.
    pause
    exit /b 1
)

echo [æª¢æŸ¥] Pythonç’°å¢ƒæ­£å¸¸
echo.

:: è¨­ç½®Pythonæ¨¡å¡Šæœç´¢è·¯å¾‘
set PYTHONPATH=%~dp0

:: åŸ·è¡Œæ¯æ—¥çˆ¬èŸ²æ”¶é›†æœ€æ–°æ–°èž (60ç¯‡ç²¾é¸)
echo æ­£åœ¨åŸ·è¡Œæ¯æ—¥çˆ¬èŸ²æ”¶é›†æœ€æ–°æ–°èž (60ç¯‡ç²¾é¸)...
echo.
"%PYTHON_PATH%" crawlers\daily_crawler_60.py

:: æª¢æŸ¥çˆ¬èŸ²åŸ·è¡Œçµæžœ
if %ERRORLEVEL% NEQ 0 (
    echo [è­¦å‘Š] çˆ¬èŸ²åŸ·è¡Œé‡åˆ°å•é¡Œï¼Œä½†ä»å°‡ç¹¼çºŒå•Ÿå‹•ç³»çµ±
    echo.
) else (
    echo [æˆåŠŸ] çˆ¬èŸ²å·²å®Œæˆå·¥ä½œï¼Œæ–°èžå·²æ›´æ–°ï¼å…±ç²å–60ç¯‡ç²¾é¸æ–°èž
    echo.
)

:: å•Ÿå‹•æ‡‰ç”¨æœå‹™å™¨
echo æ­£åœ¨å•Ÿå‹•å¾Œç«¯æœå‹™...
echo.
start /B "" "%PYTHON_PATH%" apps\start_app.py

:: ç°¡å–®ç­‰å¾…
echo ç­‰å¾…æœå‹™å™¨å•Ÿå‹•ä¸­...
ping 127.0.0.1 -n 4 >nul

:: æ‰“é–‹ç¶²é 
echo ç³»çµ±å•Ÿå‹•å®Œæˆï¼Œæ­£åœ¨æ‰“é–‹ç¶²é ...
echo.
start "" "http://127.0.0.1:5000"

:: ç­‰å¾…ç”¨æˆ¶é—œé–‰
echo.
echo ç³»çµ±å·²å•Ÿå‹•ï¼ç¶²é æ‡‰è©²æœƒè‡ªå‹•æ‰“é–‹ã€‚
echo å¦‚æžœç¶²é æ²’æœ‰è‡ªå‹•æ‰“é–‹ï¼Œè«‹æ‰‹å‹•è¨ªå•: http://127.0.0.1:5000
echo.
echo ðŸ’¡ å…¶ä»–å•Ÿå‹•æ–¹å¼ï¼š
echo    - ä½¿ç”¨ quick_start.py ç²å¾—æ›´å¤šé¸é …
echo    - ä½¿ç”¨ startup\start_7day_system.py ç²å¾—å®Œæ•´æŽ§åˆ¶
echo.
echo æŒ‰ä»»æ„éµé—œé–‰æ­¤è¦–çª—ï¼ˆé€™ä¸æœƒé—œé–‰æœå‹™å™¨ï¼‰
pause >nul

exit /b 0
